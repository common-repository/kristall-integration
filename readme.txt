=== Kristall Integration Plugin for WordPress ===

Contributors: fas27
Donate link: https://po365.ru
Tags: yml, woocommerce, e-commerce, shop, print
Requires at least: 3.0.1
Tested up to: 6.2
Stable tag: 3.2.0
Requires PHP: 7.4
License: GPLv2 or later
License URI: http://www.gnu.org/licenses/gpl-2.0.html

Плагин для обеспечения полной интеграции МБС Кристалл с Wordpress и Woocommerce.

== Description ==

**МБС Кристалл** – это бизнес-система электронной модели предприятия. Она подходит для любого вида или направления деятельности бизнеса. Организует и автоматизирует работу руководителей и специалистов, помогает в режиме реального времени осуществлять управленческий учёт, контроль, автоматическое формирование документов, осуществлять сделки, вести ЭДО с контрагентами и многое другое, что крайне необходимо для осуществления деятельности и развития собственного бизнеса на современном мировом рынке товаров и услуг.

*Современный бизнес не может существовать без эффективного сайта или интернет-магазина.*

**Плагин Кристалл Интеграция (Kristall Integration)** – инструмент поддерживающий полную интеграцию МБС Кристалл с Wordpress и Woocommerce.

**Назначение:**

Быстрое создание собственной витрины Интернет-магазина товаров и услуг в сети Интернет с возможностью выгрузки на неё номенклатуры из МБС Кристалл без дополнительных рутинных действий и ручной правки карточек товара или услуг в Wordpress и Woocommerce. Полностью автоматическое осуществление продаж и регистрация заказов в МБС Кристалл.

**Основные возможности:**

* создание актуальных карточек товара, редактирование и удаление продуктов и категорий Вашего интернет-магазина из личного кабинета МБС Кристалл;
* выгрузка товаров и услуг в «один клик» из виртуальных офисов (кабинетов) юридических лиц и индивидуальных предпринимателей из МБС Кристалл в Ваш интернет-магазин;
* настройка отображения страницы продукта и вывод дополнительных данных о товаре/услуге;
* интеграция с плагином Тинькофф банк для приема online платежей из платёжных систем, дебетовых и кредитных карт;
* выписка счетов на оплату заказанных товаров и услуг и передача информации о них в МБС Кристалл;
* упрощенное оформление заказа с минимальными необходимыми данными от покупателя;
* подтверждение заказа с помощью автоматического СМС или звонка;
* проверка данных покупателя на наличие связанного личного кабинета МБС Кристалл и, в случае его отсутствия, полностью автоматическая регистрация покупателя в системе с последующей аутентификацией;
* полная автоматизация покупки услуг обучения/образования, с дальнейшим получением позиций заказа в личном кабинете МБС Кристалл;
* осуществление продаж и учёта без необходимости контроля в личном кабинете WordPress.

**Дополнительные возможности карточки товара Интернет-магазина:**

* кнопка «Купить сейчас» на странице продукта;
* управление вкладками на странице продукта;
* шаблоны «по умолчанию» для вкладок;
* вывод произвольного содержимого на странице корзины;
* запрет на покупку физическими лицами товаров и услуг из избранных категорий;
* полная совместимость с плагином Yoast SEO.

**Задачи, которые выполняет плагин:**

1. Осуществляет интеграцию Вашего интернет-магазина на платформе WordPress +  WooCommerce с такими сервисами, как: 
 -  МБС «Кристалл» (модуль Товары и Услуги)
 -  «Тинько́фф Банк» (Интернет эквайринг)
2. Формирует актуальные трансляции (ФИДы) товаров и услуг Вашего интернет-магазина для других информационных систем, интернет-магазинов и витрин:
 -  2ГИС
 -  Яндекс Бизнес
 -  WildBerries
 -  OZON
 -  Instagram
 -  Facebook
 -  и других
  **в форматах:** YML XLSX WORD
  **и ссылок:** YML
3. Автоматически создает коммерческие предложения в формате XLS.
4. Предоставляет удобную для покупателя корзину интернет-магазина с расширенной проверкой данных.
5. Помогает создавать рекламные компании в **Яндекс Директ**, **Google Реклама**
6. Размещать рекламные компании в **Яндекс Директ** без первоначальных вложений.
7. Позволяет Вам избежать сложных технических решений.

**Помощь проекту**

Мы будем очень благодарны за вашу помощь проекту. Вы можете помочь следующими способами:

* Отправить нам сообщение об ошибке или предложение по улучшению на [info@npokristal.ru](mailto:info@npokristal.ru)
* Сделать перевод плагина или оптимизировать его для вашей страны.

== Installation ==

**Требования**

* Wordpress
* Woocommerce ([https://wordpress.org/plugins/woocommerce/](https://wordpress.org/plugins/woocommerce/))

**Опционально**

* Тинькофф Банк ([https://www.tinkoff.ru/kassa/develop/cms/](https://www.tinkoff.ru/kassa/develop/cms/)). Плагин необходим для автоматического приема платежей за продукты и услуги, без этого плагина будет доступно только выставление счетов.
* Yoast SEO ([https://wordpress.org/plugins/wordpress-seo/](https://wordpress.org/plugins/wordpress-seo/)) (Плагин Кристалл Интеграция поддерживает плагин Yoast SEO из коробки, вне зависимости от порядка установки)

**Рекомендовано**

* Cyr-To-Lat ([https://wordpress.org/plugins/cyr2lat/](https://wordpress.org/plugins/cyr2lat/)). Или любой другой плагин для транслитерации заголовков записей и продуктов.

**Установка**

1. *(Опционально)* Установка темы Porto ([https://themeforest.net/item/porto-responsive-wordpress-ecommerce-theme/9207399](https://themeforest.net/item/porto-responsive-wordpress-ecommerce-theme/9207399)). Плагин Кристалл Интеграция предназначен для любой темы WordPress, но наиболее полный функционал (например, кнопка «Купить сейчас» и вкладки на странице продукта) доступен для темы Porto.

  1.1. Скачайте и установите тему Porto.

  1.2. Настройте страницу продукта. Для этого перейдите на страницу «Porto» → «Theme Options» → «WooCommerce» → «Single Product» и выберите «Default» в секции «Product Layout». Затем найдите текстовое поле в секции «Custom Tabs Count», установите его значение в 10 и нажмите на кнопку «СОХРАНИТЬ ИЗМЕНЕНИЯ».

2. *(Опционально)* Установите плагин Тинькофф Банк. Для этого:

  2.1. Перейдите по ссылке [https://www.tinkoff.ru/kassa/develop/cms/](https://www.tinkoff.ru/kassa/develop/cms/).

  2.2. На странице найдите блок «WooCommerce».

  2.3. Выполните установку и настройку плагина, следуя инструкции (ссылка «Инструкция.pdf»).

  2.4. Перейдите на страницу «WooCommerce» → «Настройки» → «Платежи» и нажмите на кнопку «Управление» в строке Тинькофф Банк. Убедитесь, что в настройках плагина:
  * Опция «Признак способа расчета» выставлена в «Полный расчет»;
  * Опция «Признак предмета расчета» выставлена в «Платеж»;
  * Активирована опция автоматического перевода заказа в статус «Выполнен» после успешной оплаты.

3. Включите необходимые способы оплаты на странице «WooCommerce» → «Настройки» → «Платежи». Плагин Кристалл Интеграция поддерживает следующие виды платежей:
  * «Оплата при доставке» – выставление счета в МБС Кристалл для юридических лиц и ИП и добавление в корзину МБС Кристалл для физических лиц;
  * «Тинькофф Банк» - автоматический прием платежей за продукты и услуги с дебетовых и кредитных карт.

4. Перейдите на страницу «WooCommerce» → «Настройки» → «Товары» и отметьте опцию «Включить Ajax для кнопки добавления в корзину из архивов». Нажмите на кнопку «Сохранить».

5. Установите плагин Кристалл Интеграция.
6. Настройте выгрузку номенклатуры из МБС Кристалл на Ваш WordPress сайт (примечание: для выполнения этого пункта у Вашей учетной записи МБС Кристалл должен быть активирован доступ к разделу «Товары/Услуги» и разрешение «Выгрузка номенклатуры в WooCommerce»):

 6.1. Войдите в панель администратора WordPress, перейдите на страницу «WooCommerce» → «Настройки» → «Дополнительно» → «REST API» и нажмите на кнопку «Добавить ключ».

 6.2. Заполните поле «Описание» в произвольном формате и выберите свою учетную запись WordPress в поле «Пользователь». Установите опцию «Права» в значение «Чтение/Запись» и нажмите на кнопку «Генерировать ключ API».

 6.3. Скопируйте значения полей «Пользовательский ключ» и «Секретный код пользователя».

 6.4. Войдите в свою учетную запись МБС Кристалл и перейдите на страницу «Товары и услуги» → «WooCommerce» → «Настройки API».

 6.5. В поле «URL-адрес сайта» введите URL-адрес Вашего WordPress сайта, например http://my-shop.ru. В поля «Пользовательский ключ» и «Секретный код пользователя» вставьте скопированные значения соответствующих полей из настроек добавленного API-ключа (см. 6.3).

  6.6. В учетной записи МБС Кристалл, перейдите на страницу «Личный кабинет» → «Мои настройки» и скопируйте значение поля «API ключ» в секции «Настройки доступа».

  6.7. Войдите в панель администратора WordPress, перейдите на страницу «Кристалл Интеграция» и вставьте в поле «API-ключ» скопированный ключ (см. 6.6). В поле «URL-адрес МБС Кристалл» введите URL-адрес МБС Кристалл, например https://npokristal.ru.

  6.8. Проведите настройку остальных опций плагина Кристалл Интеграция при необходимости и нажмите на кнопку «Сохранить».

7. Войдите в вашу учетную запись МБС Кристалл и перейдите на страницу «Товары и услуги» → «Мои товары/услуги» → «Номенклатура». Создайте тестовый товар и выгрузите его на Ваш сайт WordPress (кнопка «Выгрузить в WooCommerce»).
8. Проведите тестовую покупку на Вашем сайте WordPress. Если при проведении покупки произошла какая-либо ошибка, попробуйте очистить cookie и кэш сайта. Например, чтобы очистить данные сайта Google Chrome в Windows:

  8.1. Откройте любую страницу Вашего WordPress сайта.

  8.2. Нажмите одновременно комбинацию клавиш CRTL + SHIFT + I (английская «И»).

  8.3. В открывшейся панели нажмите на вкладку «Application», затем в левой части панели выберите «Storage» и нажмите на кнопку «Clear site data».

  8.4. Закройте панель и перезагрузите страницу.

***Благодарим за выбор МБС Кристалл.***

== Changelog ==

= 3.2.0 =
* Добавлена обработка платежа при оплате заказа

= 3.1.0 =
* Исправлены ошибки обработки данных при оформлении заказа

= 3.0.4 =
* Улучшено управление токенами

= 3.0.3 =
* Исправлена ошибка при установке сессии Woocommerce, скрыты некоторые поля на странице редактирования продукта

= 3.0.2 =
* Исправление ошибок редактора вкладок на странице редактирования продукта

= 3.0.1 =
* Исправление ошибок сессии Woocommerce

= 3.0 =
* Публичный релиз

== Upgrade Notice ==

= 3.2.0 =
Добавлена обработка платежа при оплате заказа.

= 3.1.0 =
Исправлены ошибки обработки данных при оформлении заказа.

= 3.0.4 =
Улучшено управление токенами.

= 3.0.3 =
Исправлена ошибка при установке сессии Woocommerce, скрыты некоторые поля на странице редактирования продукта.

= 3.0.2 =
Исправлены ошибки редактора вкладок на странице редактирования продукта, из-за которых отредактированный контент не сохранялся.

= 3.0.1 =
Исправлены ошибки сессии Woocommerce, возникающие в определенных случаях и препятствующие оформлению заказа.

= 3.0 =
Финальный релиз 3.0.0.
